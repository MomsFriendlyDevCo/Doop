Angular-Filekit
===============
A collection of simple, unoppinionated widgets to help with file CRUD and uploading.


Components
==========

$filekit (service)
------------------
The main backbone of the Filekit module, this service is the oversight that holds all the other directives together.


### $filekit.uploading
An object of files that are currently being uploaded (files will not drop off when uploaded until `$filekit.settings.removeDelay` has expired).

Each key of the object is autogenerated and gurenteed to be unique.

Each object value contains the following properties:

| Key        | Type     | Description                                                             |
|------------|----------|-------------------------------------------------------------------------|
| `promise`  | Promise  | The Promise object of the `$http` call for each upload                  |
| `file`     | FileList | The Browser `FileList` type used to upload                              |
| `uploaded` | number   | The number of bytes (out of `file.size`) uploaded so far                |
| `progress` | number   | The percentage (rounded to zero decimal points) uploaded                |
| `status`   | string   | The current status of the upload. Can be `uploading`, `done` or `error` |
| `error`    | Error    | If `status == 'error'` this contains the last error raised              |


### $filekit.settings

An object containing various FileKit settings


| Key              | Type       | Default      | Description                                                                                                                               |
|------------------|------------|--------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| `removeDelay`    | number     | `5000`       | The time in milliseconds until a completed upload is removed from the `$filekit.uploading` object                                         |
| `errorHandler`   | function   | (see code)   | The error handler to use when reporting an error. Called as `(err, files)`. Replace this with your own application level error reporter   |
| `eventEmitter`   | function   | (see code)   | How to emit events. By default this function users `$rootScope.$broadcast(event, ...args)`                                                |
| `prompter`       | function   | (see code)   | How to ask the user simple text response questions. Defaults to a promise wrapped `window.prompt(options.body, options.default)`          |


## $filekit.upload(url, files)

Function used to trigger an upload and add the relevent information into `$filekit.uploading`.

Files is the browser provided `FileList` type.


filekitDropArea (component)
---------------------------
A simple component to allow the user to drop a file within the specified area (the default is the body) to trigger an upload.

```javascript
<filekit-drop-area url="/some/url"></filekit-drop-area>
```

Takes the following properties:

| Property  | Type   | Default | Description                                                                                  |
|-----------|--------|---------|----------------------------------------------------------------------------------------------|
| `element` | string | `body`  | The jQuery matching expression to use to match what area of the page should be the drop area |
| `url`     | string | none    | The endpoint to upload files to (via `$filekit.upload()`)                                    |



filekitList (component)
-----------------------
Component to display a list of files from an endpoint.

```javascript
<filekit-list url="/some/url"></filekit-list>
```

Takes the following properties:

| Property    | Type     | Default   | Description                           |
|-------------|----------|-----------|---------------------------------------|
| `url`       | string   | none      | The endpoint to retrieve files from   |
| `canRename` | boolean  | `false`   | Whether the user can rename files     |
| `canUpload` | boolean  | `false`   | Whether the user can upload new files |
| `canDelete` | boolean  | `false`   | Whether the user can delete files     |


filekitUpload (component)
-------------------------
Component to display a simple prompt to upload files, then upload them via `$filekit.upload()`.


```javascript
<filekit-upload url="/some/url">
	Click here to upload a file
</filekit-upload>
```

Takes the following properties:

| Property   | Type    | Default | Description                                     |
|------------|---------|---------|-------------------------------------------------|
| `url`      | string  | none    | The endpoint to upload files to                 |
| `multiple` | boolean | false   | Whether multiple file uploads should be allowed |


filekitUploadStatus (component)
-------------------------------
Component to display files that are currently being uploaded.


```javascript
<filekit-upload-status></filekit-upload-status>
```


Events
======
Events can be useful to detect when a file has finished and elements should be refreshed. By default `filekitList` will refresh when `filekitUploaded` is fired.

All events are fired via `$filekit.settings.eventEmitter` (which defaults to `$rootScope.$broadcast`).

The following events are fired by various Filekit components:

| Event              | Arguments | Description                                                                    |
|--------------------|-----------|--------------------------------------------------------------------------------|
| `filekitUploaded`  | `(files)` | Fired when `$filekit.upload()` has finished any file upload event              |
| `filekitFinished`  | `()`      | Fired when `$filekit.upload()` has finished the last pending file upload       |
| `filekitUpdated`   | `()`      | An operation has occured which should update the file lists (such as a delete) |
| `filekitTaskBegin` | `(id)`    | Fired when an async task begins (such as reloading a file list)                |
| `filekitTaskEnd`   | `(id)`    | Fired when an async task ends                                                  |
